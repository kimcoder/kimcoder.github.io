---
id: 소프트웨어 아키텍처 101
title: '15장, 공간 기반 아키텍처 스타일'
description: '소프트웨어 아키텍처 101 책을 읽고 내용을 정리합니다.'
keywords: 'software architecture, fundamentals of software architecture, 소프트웨어 아키텍처 101, book, study'
createdAt: 2022.07.25
---

웹 기반 비지니스 애플리케이션은 대부분 일반적인 요청 흐름을 따라간다. 브라우저에서 요청을 보내면 웹 서버, 애플리케이션 서버, 데이터베이스 서버 순서로 도달한다. 이런 패턴은 유저가 많지 않으면 별 문제없지만 유저 수가 늘어나면 점점 병목 현상이 나타나기 시작한다.
처음에는 웹 서버 레이어에서 발생하다가 나중에는 애플리케이션, 데이터베이스 서버 레이어에서도 나타난다. 병목 현상의 가장 일반적인 해결 방법은 웹 서버 확장이다.
이 방법은 비교적 쉽고 저렴하며 효과적이지만, 유저 부하가 높을 때 웹 서버 레이어를 확장하면 병목점은 다시 애플리케이션 서버로, 데이터베이스 서버로 병목점이 이동한다.

동시 유저 부하가 많은 대용량 애플리케이션은 데이터베이스의 동시 처리 가능한 트랜잭션 수가 최종 제약조건이 되는 경우가 많다. 다양한 캐시 기술과 데이터베이스 확장 제품으로 문제를 해결할 수는 있지만,
부하가 엄청나게 밀려 들어오는 상황에서 여느 애플리케이션을 확장하는 작업은 결코 만만치 않다.

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-48.jpg' />
<br />( 기존 웹 기반 토폴로지는 확장하기가 어렵다. )

**공간 기반 아키텍처 스타일은 높은 확장성, 탄력성, 동시성 및 이와 관련된 문제를 해결하기 위해 설계된 아키텍처 스타일이다.**
동시 유저 수가 매우 가변벅이라서 예측조차 곤란한 애플리케이션에서도 유용하다. 극단적이고 가변적인 확장성
문제는 데이터베이스를 확장하거나, 확장성이 떨어지는 아키텍처에 맞게 캐시 기술을 적용하는 것보다 아키텍처적으로 해결하는
것이 더 낫다.

## 15.1 토폴로지

공간 기반 아키텍처라는 명칭은 튜플 공간(tuple space)에서 유래되었다. 튜플 공간은 공유 메모리를 통해 통신하는 다중 병렬 프로세서를 사용하는 기술이다. 시스템에서 동기 제약조건인 중앙 데이터베이스를 없애는 대신, 복제된 인메모리 데이터 그리드(in-memory data grid)를 활용하면 확장성, 탄력성, 성능을 높일 수 있다.
애플리케이션 데이터는 메모리에 둔 상태로 모든 활성 처리 장치들이 데이터를 복제한다.

**공간 기반 아키텍처는 애플리케이션 코드가 구현된 처리 장치(processing unit), 처리 장치를 관리/조정하는 가상 미들웨어(virtualized middleware), 업데이트된 데이터를 데이터베이스에 비동기 전송하는 데이터 펌프(data pump), 데이터 펌프에서 데이터를 받아 업데이트를 수행하는 데이터 라이터(data writer), 처리 장치가 시작되자마자 데이터베이스의 데이터를 읽어 전달하는 데이터 리더(data reader) 컴포넌트로 구성된다.**

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-49.jpg' />
<br />

### 15.1.1 처리 장치

처리 장치는 애플리케이션 로직(또는 로직의 일부분)을 갖고 있다. 보통 웹 기반 컴포넌트와 벡엔드 비지니스 로직이 포함되나 애플리케이션 종류마다 내용물은 달라진다. 작은 웹 기반 애플리케이션은 단일 처리 장치에 배포할 수 있지만, 대규모 애플리케이션은 기능별로 여러 처리 장치에 나누어 배포해야 한다.

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-50.jpg' />
<br />

### 15.1.2 가상 미들웨어

**가상 미들웨어는 아키텍처 내부에서 데이터 동기화 및 요청 처리의 다양한 부분을 제어하는 인프라를 담당한다.** 가상 미들웨어는 메시징 그리드(messaging grid), 데이터 그리드(data grid), 처리 그리드(processing grid), 배포 관리자(deployment manager) 등의 컴포넌트로 구성된다.

#### 메시징 그리드

**메시징 그리드(messaging grid)는 입력 요청과 세션 상태를 관리한다.** 가상 미들웨어에 요청이 유입되면 메시징 그리드는 어느 활성 장치가 요청을 받아 처리할지 결정하여 해당 처리 장치로 요청을 전달한다.
이 컴포넌트는 보통 부하 분산이 가능한 일반 웹서버(예: HA 프록시, 엔진엑스)로 구현한다.

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-51.jpg' />
<br />

#### 데이터 그리드

**데이터 그리드(data grid)는 이 아키텍처 스타일에서 중요하고 필수적인 컴포넌트이다.** 요즘은 데이터 그리드가 거의 대부분 복제 캐시로서 처리 장치에만 구현되어 있지만, 외부 컨트롤러가 필요한 복제 캐시 구현체나 분산 캐시를 사용할 경우, 데이터 그리드는 가상 미들웨어 내부의 데이터 그리드 컴포넌트와 처리 장치 모두에 위치한다.
아래 그림은 처리 장치 간 동기식 데이터 복제 흐름을 나타낸 것이다. 실제로 데이터 동기화는 비동기 방식으로 매우 신속하게, 대개 100밀리초 미만으로 이루어진다.

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-52.jpg' />
<br />

#### 처리 그리드

**처리 그리드(processing grid)는 가상 미들웨어에서 필수 컴포넌트는 아니지만, 다수의 처리 장치가 단일 비지니스 요청을 처리할 경우 요청 처리를 오케스트레이트하는 일을 한다.** 또 종류가 다른 처리 장치 사이에 조정이 필요한 요청이 들어오면 처리 그리드가 두 처리 장치 사이에서 요청을 중재/조정한다.

<img className='w-8/12 m-auto' src='/assets/images/software-architecture-101-53.jpg' />
<br />

#### 배포 관리자

**배포 관리자(deployment manager)는 부하 조건에 따라 처리 장치 인스턴스를 동적으로 시작/종료하는 컴포넌트이다.** 응답 시간, 유저 부하를 계속 모니터링하다가 부하가 증가하면 새로운 처리 장치를 기동하고 반대로 감소하면 기존 처리 장치를 종료한다.
애플리케이션에서 다양한 확장성(탄력성) 요구사항을 구현하는 데 꼭 필요한 컴포넌트이다.

### 15.1.3 데이터 펌프

### 15.1.4 데이터 라이터

### 15.1.5 데이터 리더

## 15.2 데이터 충돌

## 15.3 클라우드 대 온프레미스 구현

## 15.4 복제 캐시 대 분산 캐시

## 15.5 니어 캐시

## 15.6 구현 예시

### 15.6.1 콘서트 티켓 판매 시스템

### 15.6.2 온라인 경매 시스템

## 15.7 아키텍처 특성 등급

| 아키텍처 특성 | 별점             |
| ------------- | ---------------- |
| 분할 유형     | 도메인+기술      |
| 퀀텀 수       | 하나 또는 여러개 |
| 배포성        | ⭐⭐⭐           |
| 탄력성        | ⭐⭐⭐⭐⭐       |
| 진화성        | ⭐⭐⭐           |
| 내고장성      | ⭐⭐⭐           |
| 모듈성        | ⭐⭐⭐           |
| 전체 비용     | ⭐⭐             |
| 성능          | ⭐⭐⭐⭐⭐       |
| 신뢰성        | ⭐⭐⭐⭐         |
| 확장성        | ⭐⭐⭐⭐⭐       |
| 단순성        | ⭐               |
| 시험성        | ⭐               |

---
id: 함수형 사고
title: '7장, 실용적 사고'
createdAt: 2022.02.22
---

## 7.1 자바 8

자바 8 언어 설계자들은 언어에 고계함수를 그냥 덧붙이지 않고, 교묘하게 기존의 인터페이스들이 함수형 기능을 사용할 수 있도록 만들었다.

```java
public class Process {
  public string cleanNames(List<String> names) {
    if (names == null) return "";
    return names
            .stream()
            .filter(name -> name.length() > 1)
            .map(name -> capitalize(name))
            .collect(Collectors.joining(","));
  }
}
```

자바 8의 스트림을 사용하면, `collect()`나 `forEach()`처럼 출력을 발생하는 함수(**종결 작업terminal operation이라고 부른다**)를 호출할 때까지
다른 함수들을 연결해서 합성할 수 있다.

자바는 이미 언어가 가지고 있는 클래스와 컬렉션에 **맵**과 **리듀스**와 같은 함수형 구조를 더하여, 컬렉션을 효율적으로 업데이트하는 문제를 처리한다.
스칼라나 클로저의 대부분의 컬렉션은 불변형이기 때문에 런타임이 효율적으로 조작할 수 있다. 자바8에는 `ArrayList`나 `StringBuilder`를 위해
매번 새로운 결과를 내지 않고 기존의 요소를 업데이트하는, 가변 리듀스 작업을 하는 메서드가 포함되게 되었다.

### 7.1.1 함수형 인터페이스

`Runnable`이나 `Callable` 같이 메서드를 하나만 가지는 인터페이스는 자바에서 흔하게 볼 수 있는 관용 표현이다.<br/>
이를 흔히 **단일 추상 메서드(Single Abstract Method)** 인터페이스라고 부른다. 많은 경우, SAM은 이동 가능한 코드를 운송하는 메커니즘으로 주로 사용한다.

**함수형 인터페이스(Functional interface)**라는 영리한 메커니즘은 람다와 SAM이 유용하게 상호작용할 수 있게 해준다.
함수형 인터페이스는 여러 유용한 상황에서 람다 블록이 자연스럽게 녹아들 수 있게 해준다. 자바의 관용 표현과 잘 어울리기 때문에 함수형 인터페이스는 괄목할 만한 혁신이라 하였다.

### 7.1.2 옵셔널

자바 8에서 `min()`과 같은 내장 메서드는 값 대신 `Optional`을 리턴한다. `Optional`은 오류로서의 `null`과 리턴 값으로서의 `null`을 혼용하는 것을 방지한다.
자바 8의 종결 작업은 `ifPresent()` 메서드를 사용하여 제대로 된 리턴 값에먼 코드 블록을 실행하게끔 했다.

```java
n.stream()
  .min((x, y) -> x - y)
  .ifPresent(z -> System.out.println("smallest is " + z));
```

### 7.1.3 자바 8 스트림

자바 8의 스트림은 많은 함수형 기능을 가능하게 한다.

- 스트림은 값을 저장하지 않으며, 종결 작업을 통해 입력에서 종착점까지 흐르는 파이프라인처럼 사용된다.
- 스트림은 상태를 유지하지 않는 함수형으로 설계되었다. 일례로 `filter()` 작업은 밑에 깔린 컬렉션을 바꾸지 않고 필터된 값의 스트림을 리턴한다.
- 스트림 작업은 최대한 게으르게 한다.
- 무한한 스트림이 가능하다. 일례로 모든 정수를 리턴하는 스트림을 만들어 `limit()`이나 `findFirst()` 같은 메서드를 사용하여 그 부분집합을 구할 수 있다.
- `Iterator` 인스턴스처럼 스트림은 사용과 동시에 소멸되고, 재사용 전에 다시 생성해야 한다.

스트림 작업은 **중간 작업** 또는 **종결 작업**이다. 중간 작업은 새 스트림을 리턴하고 항상 게으르다. 예를 들어 스트림의 `filter()` 작업은 사실상 필터를 하지 않고, 종결 작업이 순회할 때 필터된 값만 리턴하는 스트림을 만드는 것이다.
종결 작업은 스트림을 순회하여 값이나 부수효과를 낳는다.

## 7.2 함수형 인프라스트럭쳐
